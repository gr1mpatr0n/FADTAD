(ocamllex
   (modules lexer)
)

(menhir
   (modules parser)
   (flags -la 2 -lc 2 -O 2 --comment --dump-resolved)
)

(executable
   (public_name calc)
   (name calc)
)

(rule 
   (with-stdout-to calc.out
   (with-stdin-from calc.in
      (run ./calc.exe)
   ))
)

(rule
   (alias test)
   (action (diff calc.exp calc.out))
)

(rule
   (with-stdout-to calc1.out
   (with-stdin-from calc1.in
      (run ./calc.exe)
   ))
)

(rule
   (alias test)
   (action (diff calc1.exp calc1.out))
)